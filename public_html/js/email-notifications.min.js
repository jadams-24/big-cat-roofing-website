const EMAILJS_CONFIG={
PUBLIC_KEY: 'vRW-Ukq8hMSjaW2GJ', // Your EmailJS public key
SERVICE_ID: 'service_ais5dcc', // Your EmailJS service ID
TEMPLATE_ID: 'big_cat_contact_form' // Template ID for contact form emails
};
document.addEventListener('DOMContentLoaded', function(){
emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);
initializeContactForms();
});
function initializeContactForms(){
const formConfigs=[
{id: 'contact-form', type: 'homepage'},
{id: 'main-contact-form', type: 'contact-page'},
{id: 'service-area-contact-form', type: 'service-areas'},
{id: 'warren-contact-form', type: 'warren'},
{id: 'sterling-heights-contact-form', type: 'sterling-heights'},
{id: 'royal-oak-contact-form', type: 'royal-oak'},
{id: 'ferndale-contact-form', type: 'ferndale'},
{id: 'roseville-contact-form', type: 'roseville'},
{id: 'grosse-pointe-contact-form', type: 'grosse-pointe'}
];
formConfigs.forEach(config =>{
const form=document.getElementById(config.id);
if (form){
setupFormSubmission(form, config.type);
}
});
}
function setupFormSubmission(form, formType){
form.addEventListener('submit', async function(e){
e.preventDefault();
const submitButton=form.querySelector('button[type="submit"]');
const originalText=submitButton.textContent;
submitButton.textContent='Sending...';
submitButton.disabled=true;
try{
if (!validateForm(form)){
throw new Error('Please provide your name and either a phone number or email address so we can contact you.');
}
if (isSpamSubmission(form)){
throw new Error('Invalid submission detected. Please try again.');
}
const formData=getFormData(form, formType);
await sendEmailNotification(formData);
await sendCustomerConfirmation(formData);
showThankYouModal();
form.reset();
trackFormSubmission(formType, formData.service);
}catch (error){
console.error('Form submission error:', error);
showErrorMessage(form, error.message);
}finally{
submitButton.textContent=originalText;
submitButton.disabled=false;
}
});
}
function getFormData(form, formType){
const formData=new FormData(form);
const data={};
formData.forEach((value, key) =>{
data[key]=value;
});
data.formType=formType;
data.timestamp=new Date().toLocaleString('en-US',{
timeZone: 'America/Detroit',
year: 'numeric',
month: 'long',
day: 'numeric',
hour: '2-digit',
minute: '2-digit',
second: '2-digit'
});
data.userAgent=navigator.userAgent;
data.referrer=document.referrer || 'Direct';
data.currentUrl=window.location.href;
data.userIp='Detected by server';
return data;
}
async function sendEmailNotification(data){
const emailParams={
to_email: 'jordan@bigcatroofs.com',
from_name: 'Big Cat Roofing Website',
subject: `New Lead from Big Cat Roofing Website - ${data.service || 'General Inquiry'}`,
customer_name: data.name || 'Not provided',
customer_phone: data.phone || 'Not provided',
customer_email: data.email || 'Not provided',
service_requested: data.service || 'Not specified',
customer_message: data.message || 'No message provided',
property_address: data.address || data.warren_address || data.sterling_heights_address || 'Not provided',
city_area: data.city || getLocationFromFormType(data.formType),
project_urgency: data.urgency || 'Normal',
newsletter_signup: data.newsletter ? 'Yes' : 'No',
lead_source: `Website Contact Form (${data.formType})`,
submission_time: data.timestamp,
customer_ip: data.userIp,
user_agent: data.userAgent,
referrer: data.referrer,
form_url: data.currentUrl
};
try{
const response=await emailjs.send(
EMAILJS_CONFIG.SERVICE_ID,
EMAILJS_CONFIG.TEMPLATE_ID,
emailParams
);
console.log('Office notification sent successfully:', response);
return response;
}catch (error){
console.error('Failed to send office notification:', error);
throw new Error('Failed to send notification. Please try again or call us directly at 248-709-3746.');
}
}
async function sendCustomerConfirmation(data){
const confirmationParams={
to_email: data.email,
to_name: data.name,
from_name: 'Big Cat Roofing',
subject: 'Thank you for your roofing inquiry - Big Cat Roofing',
customer_name: data.name,
service_requested: data.service || 'General Inquiry',
phone_number: '248-709-3746',
website: 'BigCatRoofs.com',
submission_time: data.timestamp
};
try{
const response=await emailjs.send(
EMAILJS_CONFIG.SERVICE_ID,
'customer_confirmation', // Separate template for customer emails
confirmationParams
);
console.log('Customer confirmation sent successfully:', response);
return response;
}catch (error){
console.error('Failed to send customer confirmation:', error);
}
}
function validateForm(form){
const allFields=form.querySelectorAll('input, select, textarea');
allFields.forEach(field =>{field.classList.remove('error');});
const name=form.querySelector('[name="name"]')?.value?.trim();
const phone=form.querySelector('[name="phone"]')?.value?.trim();
const email=form.querySelector('[name="email"]')?.value?.trim();
if (!name || (!phone && !email)){
if (!name){const nameField=form.querySelector('[name="name"]');if (nameField) nameField.classList.add('error');}
if (!phone && !email){const phoneField=form.querySelector('[name="phone"]');const emailField=form.querySelector('[name="email"]');if (phoneField) phoneField.classList.add('error');if (emailField) emailField.classList.add('error');}
return false;
}
if (email){const emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if (!emailRegex.test(email)){const emailField=form.querySelector('[name="email"]');if (emailField) emailField.classList.add('error');return false;}}
return true;
}
function showSuccessMessage(form){
removeStatusMessages(form);
const successMessage=document.createElement('div');
successMessage.className='form-message success-message';
successMessage.innerHTML=`
<div class="message-content">
<svg class="message-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
<path d="M9 11l3 3L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
<div class="message-text">
<h4>Thank You!</h4>
<p>Your inquiry has been received. We'll contact you within 24 hours to schedule your free estimate.</p>
<p><strong>Need immediate assistance?</strong><br>
Call us now: <a href="tel:248-709-3746">248-709-3746</a></p>
</div>
</div>
`;
form.parentNode.insertBefore(successMessage, form);
setTimeout(() =>{
if (successMessage.parentNode){
successMessage.parentNode.removeChild(successMessage);
}
}, 10000);
}
function showErrorMessage(form, message){
removeStatusMessages(form);
const errorMessage=document.createElement('div');
errorMessage.className='form-message error-message';
errorMessage.innerHTML=`
<div class="message-content">
<svg class="message-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
<line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
<line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
</svg>
<div class="message-text">
<h4>Submission Failed</h4>
<p>${message}</p>
<p><strong>Alternative contact methods:</strong><br>
Call: <a href="tel:248-709-3746">248-709-3746</a><br>
Email: <a href="mailto:jordan@bigcatroofs.com">jordan@bigcatroofs.com</a></p>
</div>
</div>
`;
form.parentNode.insertBefore(errorMessage, form);
setTimeout(() =>{
if (errorMessage.parentNode){
errorMessage.parentNode.removeChild(errorMessage);
}
}, 15000);
}
function removeStatusMessages(form){
const existingMessages=form.parentNode.querySelectorAll('.form-message');
existingMessages.forEach(message =>{
if (message.parentNode){
message.parentNode.removeChild(message);
}
});
}
function getLocationFromFormType(formType){
const locationMap={
'warren': 'Warren, MI',
'sterling-heights': 'Sterling Heights, MI',
'royal-oak': 'Royal Oak, MI',
'ferndale': 'Ferndale, MI',
'roseville': 'Roseville, MI',
'grosse-pointe': 'Grosse Pointe, MI',
'homepage': 'Website Homepage',
'contact-page': 'Contact Page',
'service-areas': 'Service Areas Page'
};
return locationMap[formType] || 'Metro Detroit';
}
function trackFormSubmission(formType, service){
if (typeof gtag !== 'undefined'){
gtag('event', 'form_submit',{
'event_category': 'Contact',
'event_label': `${formType}- ${service}`,
'form_type': formType,
'service_type': service
});
}
if (typeof fbq !== 'undefined'){
fbq('track', 'Lead',{
content_name: 'Contact Form Submission',
content_category: formType,
service_type: service
});
}
console.log('Form submission tracked:',{formType, service});
}
function isSpamSubmission(form){
const formData=new FormData(form);
const name=formData.get('name') || '';
const email=formData.get('email') || '';
const message=formData.get('message') || '';
const spamPatterns=[
/viagra|cialis|pharmacy|casino|gambling/i,
/http:\/\/|https:\/\/.*\.tk|.*\.ml/i,
/\b(SEO|link building|backlink)\b/i
];
const allText=`${name}${email}${message}`.toLowerCase();
return spamPatterns.some(pattern => pattern.test(allText));
}
window.BigCatEmailNotifications={
initializeContactForms,
setupFormSubmission,
validateForm,
sendEmailNotification,
sendCustomerConfirmation,
isSpamSubmission
};
window.EMAILJS_CONFIG=EMAILJS_CONFIG;
function showThankYouModal(){const modal=document.getElementById('thankYouModal');if(modal){document.body.classList.add('thank-you-modal-open');modal.style.display='flex';setTimeout(()=>{modal.classList.add('show')},10);const closeButton=modal.querySelector('.modal-close');if(closeButton){setTimeout(()=>{closeButton.focus()},300)}setTimeout(()=>{closeThankYouModal()},15000);document.addEventListener('keydown',handleThankYouModalEscape)}}
function closeThankYouModal(){const modal=document.getElementById('thankYouModal');if(modal){modal.classList.remove('show');setTimeout(()=>{modal.style.display='none';document.body.classList.remove('thank-you-modal-open')},300);document.removeEventListener('keydown',handleThankYouModalEscape)}}
function handleThankYouModalEscape(event){if(event.key==='Escape'){closeThankYouModal()}}
window.showThankYouModal=showThankYouModal;window.closeThankYouModal=closeThankYouModal;